<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oncor Concrete Estimator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        header h1 {
            font-size: 2.5rem;
            color: #f5a623;
            margin-bottom: 5px;
        }
        
        header p {
            color: #888;
            font-size: 1.1rem;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .card {
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 25px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .card h2 {
            color: #f5a623;
            margin-bottom: 20px;
            font-size: 1.3rem;
            border-bottom: 2px solid #f5a623;
            padding-bottom: 10px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            color: #ccc;
            font-size: 0.9rem;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 8px;
            background: rgba(0,0,0,0.3);
            color: #fff;
            font-size: 1rem;
        }
        
        input:focus, select:focus {
            outline: none;
            border-color: #f5a623;
        }
        
        .row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .row-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
        }
        
        button {
            background: linear-gradient(135deg, #f5a623 0%, #e8940c 100%);
            color: #000;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(245, 166, 35, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255,255,255,0.1);
            color: #fff;
        }
        
        .btn-secondary:hover {
            background: rgba(255,255,255,0.2);
            box-shadow: none;
        }
        
        .actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }
        
        .summary {
            background: rgba(245, 166, 35, 0.1);
            border: 2px solid #f5a623;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .summary-item {
            background: rgba(0,0,0,0.2);
            padding: 15px;
            border-radius: 8px;
        }
        
        .summary-item label {
            font-size: 0.85rem;
            color: #888;
        }
        
        .summary-item .value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #f5a623;
        }
        
        .total-row {
            grid-column: 1 / -1;
            background: #f5a623;
            color: #000;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .total-row label {
            color: #000;
            font-weight: bold;
        }
        
        .total-row .value {
            font-size: 2.5rem;
            color: #000;
        }
        
        .line-items {
            margin-top: 15px;
        }
        
        .line-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .line-item:last-child {
            border-bottom: none;
        }
        
        .project-info input {
            background: rgba(0,0,0,0.2);
        }
        
        .helper {
            font-size: 0.8rem;
            color: #666;
            margin-top: 3px;
        }

        @media (max-width: 768px) {
            .row, .row-3, .summary-grid {
                grid-template-columns: 1fr;
            }
            
            .actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>âš¡ ONCOR</h1>
            <p>Concrete Estimating Calculator</p>
        </header>

        <!-- Project Info -->
        <div class="card project-info">
            <h2>ðŸ“‹ Project Information</h2>
            <div class="row">
                <div class="form-group">
                    <label>Project Name</label>
                    <input type="text" id="projectName" placeholder="e.g., Smith Residence Foundation">
                </div>
                <div class="form-group">
                    <label>Client Name</label>
                    <input type="text" id="clientName" placeholder="e.g., ABC Construction">
                </div>
            </div>
            <div class="row">
                <div class="form-group">
                    <label>Project Address</label>
                    <input type="text" id="projectAddress" placeholder="123 Main St, El Paso, TX">
                </div>
                <div class="form-group">
                    <label>Estimate Date</label>
                    <input type="date" id="estimateDate">
                </div>
            </div>
        </div>

        <div class="grid">
            <!-- Concrete Work -->
            <div class="card">
                <h2>ðŸ§± Concrete Work</h2>
                
                <div class="form-group">
                    <label>Work Type</label>
                    <select id="workType">
                        <option value="slab">Slab on Grade</option>
                        <option value="footing">Footings</option>
                        <option value="wall">Foundation Walls</option>
                        <option value="flatwork">Flatwork (Driveways, Patios)</option>
                        <option value="stemwall">Stem Walls</option>
                    </select>
                </div>
                
                <div class="row-3">
                    <div class="form-group">
                        <label>Length (ft)</label>
                        <input type="number" id="length" value="50" min="0" step="0.5">
                    </div>
                    <div class="form-group">
                        <label>Width (ft)</label>
                        <input type="number" id="width" value="30" min="0" step="0.5">
                    </div>
                    <div class="form-group">
                        <label>Thickness (in)</label>
                        <input type="number" id="thickness" value="4" min="0" step="0.5">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Concrete PSI</label>
                    <select id="concretePsi">
                        <option value="3000">3000 PSI</option>
                        <option value="3500" selected>3500 PSI</option>
                        <option value="4000">4000 PSI</option>
                        <option value="4500">4500 PSI</option>
                        <option value="5000">5000 PSI</option>
                    </select>
                </div>
            </div>

            <!-- Material Costs -->
            <div class="card">
                <h2>ðŸ’° Material Costs</h2>
                
                <div class="form-group">
                    <label>Concrete Cost (per cubic yard)</label>
                    <input type="number" id="concreteCost" value="145" min="0" step="5">
                    <p class="helper">Local El Paso avg: $140-160/ydÂ³</p>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label>Rebar (#4 per linear ft)</label>
                        <input type="number" id="rebarCost" value="0.75" min="0" step="0.05">
                    </div>
                    <div class="form-group">
                        <label>Rebar Spacing (inches)</label>
                        <input type="number" id="rebarSpacing" value="12" min="6" step="2">
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label>Forms (per linear ft)</label>
                        <input type="number" id="formsCost" value="3.50" min="0" step="0.25">
                    </div>
                    <div class="form-group">
                        <label>Finishing (per sq ft)</label>
                        <input type="number" id="finishingCost" value="0.75" min="0" step="0.05">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Waste Factor (%)</label>
                    <input type="number" id="wasteFactor" value="10" min="0" max="25" step="1">
                </div>
            </div>

            <!-- Labor -->
            <div class="card">
                <h2>ðŸ‘· Labor</h2>
                
                <div class="row">
                    <div class="form-group">
                        <label>Crew Size</label>
                        <input type="number" id="crewSize" value="4" min="1" step="1">
                    </div>
                    <div class="form-group">
                        <label>Hourly Rate (per worker)</label>
                        <input type="number" id="laborRate" value="35" min="0" step="1">
                    </div>
                </div>
                
                <div class="row">
                    <div class="form-group">
                        <label>Estimated Hours</label>
                        <input type="number" id="laborHours" value="16" min="0" step="0.5">
                    </div>
                    <div class="form-group">
                        <label>Foreman Premium (%)</label>
                        <input type="number" id="foremanPremium" value="25" min="0" step="5">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Equipment/Tools (flat fee)</label>
                    <input type="number" id="equipmentCost" value="500" min="0" step="50">
                </div>
            </div>

            <!-- Markup -->
            <div class="card">
                <h2>ðŸ“ˆ Markup & Margins</h2>
                
                <div class="form-group">
                    <label>Overhead (%)</label>
                    <input type="number" id="overhead" value="10" min="0" max="50" step="1">
                    <p class="helper">Office, insurance, vehicle, etc.</p>
                </div>
                
                <div class="form-group">
                    <label>Profit Margin (%)</label>
                    <input type="number" id="profitMargin" value="20" min="0" max="50" step="1">
                </div>
                
                <div class="form-group">
                    <label>Contingency (%)</label>
                    <input type="number" id="contingency" value="5" min="0" max="25" step="1">
                    <p class="helper">Buffer for unknowns</p>
                </div>
            </div>
        </div>

        <div class="actions">
            <button onclick="calculateEstimate()">âš¡ Calculate Estimate</button>
            <button class="btn-secondary" onclick="generatePDF()">ðŸ“„ Generate PDF</button>
            <button class="btn-secondary" onclick="resetForm()">ðŸ”„ Reset</button>
        </div>

        <!-- Summary -->
        <div class="card summary" id="summaryCard" style="display: none;">
            <h2>ðŸ“Š Estimate Summary</h2>
            
            <div class="line-items" id="lineItems"></div>
            
            <div class="summary-grid">
                <div class="summary-item">
                    <label>Square Footage</label>
                    <div class="value" id="sqftValue">--</div>
                </div>
                <div class="summary-item">
                    <label>Cubic Yards</label>
                    <div class="value" id="cubicYardsValue">--</div>
                </div>
                <div class="summary-item">
                    <label>Material Cost</label>
                    <div class="value" id="materialCostValue">--</div>
                </div>
                <div class="summary-item">
                    <label>Labor Cost</label>
                    <div class="value" id="laborCostValue">--</div>
                </div>
                <div class="summary-item">
                    <label>Subtotal</label>
                    <div class="value" id="subtotalValue">--</div>
                </div>
                <div class="summary-item">
                    <label>Markup</label>
                    <div class="value" id="markupValue">--</div>
                </div>
                <div class="total-row">
                    <label>TOTAL ESTIMATE</label>
                    <div class="value" id="totalValue">--</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Set today's date
        document.getElementById('estimateDate').valueAsDate = new Date();
        
        let lastEstimate = null;
        
        function calculateEstimate() {
            // Get dimensions
            const length = parseFloat(document.getElementById('length').value) || 0;
            const width = parseFloat(document.getElementById('width').value) || 0;
            const thickness = parseFloat(document.getElementById('thickness').value) || 0;
            const workType = document.getElementById('workType').value;
            
            // Calculate area and volume
            const sqft = length * width;
            const cubicFeet = sqft * (thickness / 12);
            const cubicYards = cubicFeet / 27;
            const wasteFactor = parseFloat(document.getElementById('wasteFactor').value) / 100;
            const cubicYardsWithWaste = cubicYards * (1 + wasteFactor);
            
            // Material costs
            const concreteCost = parseFloat(document.getElementById('concreteCost').value) || 0;
            const rebarCost = parseFloat(document.getElementById('rebarCost').value) || 0;
            const rebarSpacing = parseFloat(document.getElementById('rebarSpacing').value) || 12;
            const formsCost = parseFloat(document.getElementById('formsCost').value) || 0;
            const finishingCost = parseFloat(document.getElementById('finishingCost').value) || 0;
            
            // Calculate rebar linear feet (grid pattern)
            const rebarLengthWise = Math.ceil(width / (rebarSpacing / 12)) * length;
            const rebarWidthWise = Math.ceil(length / (rebarSpacing / 12)) * width;
            const totalRebarLF = rebarLengthWise + rebarWidthWise;
            
            // Perimeter for forms
            const perimeter = 2 * (length + width);
            
            // Material totals
            const concreteTotal = cubicYardsWithWaste * concreteCost;
            const rebarTotal = totalRebarLF * rebarCost;
            const formsTotal = perimeter * formsCost;
            const finishingTotal = sqft * finishingCost;
            const materialSubtotal = concreteTotal + rebarTotal + formsTotal + finishingTotal;
            
            // Labor costs
            const crewSize = parseInt(document.getElementById('crewSize').value) || 1;
            const laborRate = parseFloat(document.getElementById('laborRate').value) || 0;
            const laborHours = parseFloat(document.getElementById('laborHours').value) || 0;
            const foremanPremium = parseFloat(document.getElementById('foremanPremium').value) / 100;
            const equipmentCost = parseFloat(document.getElementById('equipmentCost').value) || 0;
            
            const baseLaborCost = (crewSize - 1) * laborRate * laborHours;
            const foremanCost = laborRate * (1 + foremanPremium) * laborHours;
            const laborSubtotal = baseLaborCost + foremanCost + equipmentCost;
            
            // Subtotal before markup
            const subtotal = materialSubtotal + laborSubtotal;
            
            // Markup
            const overhead = parseFloat(document.getElementById('overhead').value) / 100;
            const profitMargin = parseFloat(document.getElementById('profitMargin').value) / 100;
            const contingency = parseFloat(document.getElementById('contingency').value) / 100;
            
            const overheadAmount = subtotal * overhead;
            const profitAmount = subtotal * profitMargin;
            const contingencyAmount = subtotal * contingency;
            const totalMarkup = overheadAmount + profitAmount + contingencyAmount;
            
            const total = subtotal + totalMarkup;
            
            // Store for PDF
            lastEstimate = {
                projectName: document.getElementById('projectName').value || 'Untitled Project',
                clientName: document.getElementById('clientName').value || '',
                projectAddress: document.getElementById('projectAddress').value || '',
                estimateDate: document.getElementById('estimateDate').value,
                workType: document.getElementById('workType').options[document.getElementById('workType').selectedIndex].text,
                dimensions: { length, width, thickness },
                sqft,
                cubicYards: cubicYardsWithWaste,
                lineItems: [
                    { name: `Concrete (${cubicYardsWithWaste.toFixed(1)} ydÂ³ @ $${concreteCost}/ydÂ³)`, amount: concreteTotal },
                    { name: `Rebar (${totalRebarLF.toFixed(0)} LF @ $${rebarCost}/LF)`, amount: rebarTotal },
                    { name: `Forms (${perimeter.toFixed(0)} LF @ $${formsCost}/LF)`, amount: formsTotal },
                    { name: `Finishing (${sqft.toFixed(0)} SF @ $${finishingCost}/SF)`, amount: finishingTotal },
                    { name: `Labor (${crewSize} crew Ã— ${laborHours} hrs)`, amount: baseLaborCost + foremanCost },
                    { name: 'Equipment & Tools', amount: equipmentCost },
                ],
                materialSubtotal,
                laborSubtotal,
                subtotal,
                overhead: overheadAmount,
                profit: profitAmount,
                contingency: contingencyAmount,
                totalMarkup,
                total
            };
            
            // Update display
            document.getElementById('summaryCard').style.display = 'block';
            document.getElementById('sqftValue').textContent = sqft.toFixed(0) + ' SF';
            document.getElementById('cubicYardsValue').textContent = cubicYardsWithWaste.toFixed(1) + ' ydÂ³';
            document.getElementById('materialCostValue').textContent = formatCurrency(materialSubtotal);
            document.getElementById('laborCostValue').textContent = formatCurrency(laborSubtotal);
            document.getElementById('subtotalValue').textContent = formatCurrency(subtotal);
            document.getElementById('markupValue').textContent = formatCurrency(totalMarkup);
            document.getElementById('totalValue').textContent = formatCurrency(total);
            
            // Line items
            const lineItemsHtml = lastEstimate.lineItems.map(item => `
                <div class="line-item">
                    <span>${item.name}</span>
                    <span>${formatCurrency(item.amount)}</span>
                </div>
            `).join('');
            document.getElementById('lineItems').innerHTML = lineItemsHtml;
            
            // Scroll to summary
            document.getElementById('summaryCard').scrollIntoView({ behavior: 'smooth' });
        }
        
        function formatCurrency(amount) {
            return '$' + amount.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ',');
        }
        
        function generatePDF() {
            if (!lastEstimate) {
                alert('Please calculate an estimate first!');
                return;
            }
            
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const pageWidth = doc.internal.pageSize.getWidth();
            const margin = 20;
            let y = 20;
            
            // Header
            doc.setFillColor(245, 166, 35);
            doc.rect(0, 0, pageWidth, 40, 'F');
            
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(28);
            doc.setFont('helvetica', 'bold');
            doc.text('ONCOR', margin, 28);
            
            doc.setFontSize(12);
            doc.setFont('helvetica', 'normal');
            doc.text('Concrete Estimating', pageWidth - margin, 20, { align: 'right' });
            doc.text('El Paso, Texas', pageWidth - margin, 28, { align: 'right' });
            
            y = 55;
            
            // Project Info
            doc.setTextColor(50, 50, 50);
            doc.setFontSize(18);
            doc.setFont('helvetica', 'bold');
            doc.text('ESTIMATE', margin, y);
            
            y += 10;
            doc.setFontSize(11);
            doc.setFont('helvetica', 'normal');
            doc.text(`Project: ${lastEstimate.projectName}`, margin, y);
            y += 7;
            if (lastEstimate.clientName) {
                doc.text(`Client: ${lastEstimate.clientName}`, margin, y);
                y += 7;
            }
            if (lastEstimate.projectAddress) {
                doc.text(`Location: ${lastEstimate.projectAddress}`, margin, y);
                y += 7;
            }
            doc.text(`Date: ${lastEstimate.estimateDate}`, margin, y);
            y += 15;
            
            // Scope
            doc.setFillColor(240, 240, 240);
            doc.rect(margin, y - 5, pageWidth - 2 * margin, 25, 'F');
            
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text('SCOPE OF WORK', margin + 5, y + 5);
            doc.setFont('helvetica', 'normal');
            doc.setFontSize(11);
            doc.text(`${lastEstimate.workType}: ${lastEstimate.dimensions.length}' Ã— ${lastEstimate.dimensions.width}' Ã— ${lastEstimate.dimensions.thickness}"`, margin + 5, y + 15);
            
            y += 35;
            
            // Line Items
            doc.setFontSize(12);
            doc.setFont('helvetica', 'bold');
            doc.text('COST BREAKDOWN', margin, y);
            y += 8;
            
            doc.setDrawColor(200, 200, 200);
            doc.line(margin, y, pageWidth - margin, y);
            y += 8;
            
            doc.setFontSize(10);
            doc.setFont('helvetica', 'normal');
            
            lastEstimate.lineItems.forEach(item => {
                doc.text(item.name, margin, y);
                doc.text(formatCurrency(item.amount), pageWidth - margin, y, { align: 'right' });
                y += 7;
            });
            
            y += 5;
            doc.line(margin, y, pageWidth - margin, y);
            y += 10;
            
            // Subtotals
            doc.setFont('helvetica', 'bold');
            doc.text('Subtotal', margin, y);
            doc.text(formatCurrency(lastEstimate.subtotal), pageWidth - margin, y, { align: 'right' });
            y += 8;
            
            doc.setFont('helvetica', 'normal');
            doc.text(`Overhead (${document.getElementById('overhead').value}%)`, margin, y);
            doc.text(formatCurrency(lastEstimate.overhead), pageWidth - margin, y, { align: 'right' });
            y += 7;
            
            doc.text(`Profit (${document.getElementById('profitMargin').value}%)`, margin, y);
            doc.text(formatCurrency(lastEstimate.profit), pageWidth - margin, y, { align: 'right' });
            y += 7;
            
            doc.text(`Contingency (${document.getElementById('contingency').value}%)`, margin, y);
            doc.text(formatCurrency(lastEstimate.contingency), pageWidth - margin, y, { align: 'right' });
            y += 10;
            
            // Total
            doc.setFillColor(245, 166, 35);
            doc.rect(margin, y - 5, pageWidth - 2 * margin, 20, 'F');
            
            doc.setTextColor(0, 0, 0);
            doc.setFontSize(14);
            doc.setFont('helvetica', 'bold');
            doc.text('TOTAL ESTIMATE', margin + 5, y + 8);
            doc.text(formatCurrency(lastEstimate.total), pageWidth - margin - 5, y + 8, { align: 'right' });
            
            y += 30;
            
            // Terms
            doc.setTextColor(100, 100, 100);
            doc.setFontSize(9);
            doc.setFont('helvetica', 'normal');
            doc.text('TERMS & CONDITIONS', margin, y);
            y += 6;
            doc.setFontSize(8);
            doc.text('â€¢ This estimate is valid for 30 days from the date above.', margin, y); y += 5;
            doc.text('â€¢ 50% deposit required to schedule work, balance due upon completion.', margin, y); y += 5;
            doc.text('â€¢ Price assumes reasonable access and standard soil conditions.', margin, y); y += 5;
            doc.text('â€¢ Additional charges may apply for unforeseen conditions or changes.', margin, y);
            
            // Footer
            doc.setTextColor(150, 150, 150);
            doc.setFontSize(8);
            doc.text('Generated by Oncor Estimating System', pageWidth / 2, 285, { align: 'center' });
            
            // Save
            const fileName = `Oncor_Estimate_${lastEstimate.projectName.replace(/[^a-z0-9]/gi, '_')}_${lastEstimate.estimateDate}.pdf`;
            doc.save(fileName);
        }
        
        function resetForm() {
            document.getElementById('projectName').value = '';
            document.getElementById('clientName').value = '';
            document.getElementById('projectAddress').value = '';
            document.getElementById('estimateDate').valueAsDate = new Date();
            document.getElementById('length').value = '50';
            document.getElementById('width').value = '30';
            document.getElementById('thickness').value = '4';
            document.getElementById('summaryCard').style.display = 'none';
            lastEstimate = null;
        }
    </script>
</body>
</html>
